{% extends 'base.html' %}
{% load static %}
{% load blog_tags %}

{% block content %}

    <!-- Mobile Nav -->
    <div class="mobile-nav-overlay" onclick="toggleMobileNav()"></div>
    <div class="mobile-nav">
        <button class="close-nav" onclick="toggleMobileNav()">โ</button>
        <a href="index.html">ุฎุงูู</a>
        <button class="mobile-dropdown-toggle" onclick="toggleMobileDropdown()">ุฏุณุชูโุจูุฏโูุง <span
                class="m-arrow">โพ</span></button>
        <div class="mobile-dropdown-menu" style="display:none;">
            <a href="index.html?cat=ุชฺฉููููฺ">๐ฑ ุชฺฉููููฺ</a>
            <a href="index.html?cat=ุจุฑูุงููโููุณ">๐ป ุจุฑูุงููโููุณ</a>
            <a href="index.html?cat=ุณุจฺฉ ุฒูุฏฺฏ">๐ฟ ุณุจฺฉ ุฒูุฏฺฏ</a>
            <a href="index.html?cat=ุขููุฒุด">๐ ุขููุฒุด</a>
            <a href="index.html?cat=ฺฉุชุงุจ">๐ ฺฉุชุงุจ ู ูุทุงูุนู</a>
        </div>
        <a href="about.html">ุฏุฑุจุงุฑู ูุง</a>
        <a href="contact.html">ุชูุงุณ</a>
        <div style="margin-top: 20px; display: flex; gap: 8px; align-items: center;">
            <button class="theme-toggle" onclick="toggleTheme()" style="width:36px;height:36px;font-size:15px;"><span
                    class="theme-icon">๐</span></button>
            <button class="btn btn-outline btn-sm" onclick="openModal('login'); toggleMobileNav();">ูุฑูุฏ</button>
            <button class="btn btn-primary btn-sm" onclick="openModal('signup'); toggleMobileNav();">ุนุถูุช</button>
        </div>
    </div>

    <!-- =================== HOME VIEW =================== -->
    <div id="homeView">
        <!-- Hero -->
        <section class="hero">
            <div class="container">
                {% if not search_query %}
                    <h1>๐ ุจู ุฏูุง ููุดุชุงุฑ ุฎูุด ุขูุฏุฏ</h1>
                    <p>ููุงูุงุช ุชุฎุตุต ุฏุฑ ุญูุฒู ุชฺฉููููฺุ ุจุฑูุงููโููุณ ู ุณุจฺฉ ุฒูุฏฺฏ. ูุฑ ุฑูุฒ ฺุฒ ุฌุฏุฏ ุงุฏ ุจฺฏุฑุฏ.</p>
                    <div class="hero-search">
                        <input type="text" placeholder="ุฏูุจุงู ฺู ูุทูุจ ูโฺฏุฑุฏุฏุ" id="heroSearchInput">
                        <button id="heroSearchBtn">ุฌุณุชุฌู</button>
                    </div>
                {% else %}
                    <h1 id="categoryTitle">๐ ูุชุงุฌ ุฌุณุชุฌู: {{ search_query }}</h1>
                    <p>ุชูุงู ูุทุงูุจ ูุฑุชุจุท ุจุง ุงู ุฏุณุชูโุจูุฏ</p>
                {% endif %}
            </div>
        </section>

        {% if not search_query %}
            <!-- Featured Posts -->
            <section class="featured">
                <div class="container">
                    <h2 class="section-title">๐ฅ ูุทุงูุจ ูฺู</h2>
                    <div class="featured-grid">
                        <a href="post.html?id=0" class="featured-card">
                            <img src="https://images.unsplash.com/photo-1517694712202-14dd9538aa97?w=700&h=400&fit=crop"
                                 alt="">
                            <div class="overlay">
                                <span class="cat">ุจุฑูุงููโููุณ</span>
                                <h3>ุฑุงูููุง ุฌุงูุน ุดุฑูุน ุจุฑูุงููโููุณ ุจุง ูพุงุชูู ุฏุฑ ุณุงู ฑดฐณ</h3>
                                <div class="meta">ุนู ูุญูุฏ ยท ฑต ุขุจุงู ฑดฐณ ยท ฑฒ ุฏููู ูุทุงูุนู</div>
                            </div>
                        </a>
                        <a href="post.html?id=1" class="featured-card">
                            <img src="https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?w=700&h=400&fit=crop"
                                 alt="">
                            <div class="overlay">
                                <span class="cat">ุชฺฉููููฺ</span>
                                <h3>ุขูุฏู ููุด ูุตููุน ู ุชุฃุซุฑ ุขู ุจุฑ ุฒูุฏฺฏ ุฑูุฒูุฑู</h3>
                                <div class="meta">ุณุงุฑุง ุงุญูุฏ ยท ฑฒ ุขุจุงู ฑดฐณ ยท ธ ุฏููู ูุทุงูุนู</div>
                            </div>
                        </a>
                    </div>
                </div>
            </section>
        {% endif %}

        <!-- Main Content -->
        <section class="main-content">
            <div class="container">
                <div class="content-grid">
                    {% if not search_query %}
                        <div>
                        <h2 class="section-title">๐ฐ ุขุฎุฑู ูุทุงูุจ</h2>
                    {% endif %}
                    <div id="postsList">
                        {% if posts %}
                            {% for post in posts %}
                                <a href="#" class="post-card post-card-horizontal">
                                    <div class="post-thumb"><img
                                            src="{{ post.image.url }}"
                                            alt="{{ post.title }}"></div>
                                    <div class="post-card-body"><span class="post-cat">{{ post.category.name }}</span>
                                        <h3>{{ post.title }}</h3>
                                        <p>{{ post.content|truncatechars:100 }}</p>
                                        <div class="post-meta"><span class="author"><img
                                                src="{{ post.user.image.url }}"
                                                alt="">{{ post.user.full_name }}</span><span>๐ {{ post.published_at.date }}</span><span>โฑ {{ post.estimated_reading_time|persian_int }} ุฏููู</span>
                                        </div>
                                        <div class="post-tags">
                                            {% for tag in post.tags.all %}
                                                <span class="post-tag">#{{ tag.name }}</span>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </a>
                            {% endfor %}
                            <div class="pagination">
                                {% if page_obj.has_previous %}
                                    <a href="?page={{ page_obj.previous_page_number }}">ยซ</a>
                                {% endif %}
                                {% for i in page_obj.paginator.page_range %}
                                    {% if page_obj.number == i %}
                                        <span class="active">{{ i }}</span>
                                    {% else %}
                                        <a href="?page={{ i }}">{{ i }}</a>
                                    {% endif %}
                                {% endfor %}
                                {% if page_obj.has_next %}
                                    <a href="?page={{ page_obj.next_page_number }}">ยป</a>
                                {% endif %}
                            </div>
                            </div>
                        {% else %}
                            <div style="text-align:center;padding:60px;color:var(--text-light);"><h3>ูุชุฌูโุง ุงูุช ูุดุฏ
                                ๐</h3>
                                <p>ูุทูุงู ุนุจุงุฑุช ุฏฺฏุฑ ุฑุง ุฌุณุชุฌู ฺฉูุฏ.</p></div>
                        {% endif %}
                    </div>
                    <aside class="sidebar">
                        <div class="widget about-widget">
                            <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150&h=150&fit=crop"
                                 alt="ููุณูุฏู">
                            <h4>ุนู ูุญูุฏ</h4>
                            <p>ุชูุณุนูโุฏููุฏู ูุจ ู ููุณูุฏู ููุงูุงุช ุชฺฉููููฺ. ุนุงุดู ุงุฏฺฏุฑ ู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุฏุงูุด.</p>
                            <div class="about-socials">
                                <a href="#">๐</a><a href="#">in</a><a href="#">๐ท</a><a href="#">โ๏ธ</a>
                            </div>
                        </div>
                        {% blog_categories %}
                        {% latest_posts %}
                        {% tags %}
                        <div class="widget newsletter-widget">
                            <h3 class="widget-title">๐ฌ ุฎุจุฑูุงูู</h3>
                            <p>ุขุฎุฑู ูุทุงูุจ ู ุขููุฒุดโูุง ุฑุง ูุณุชูู ุฏุฑ ุงูู ุฎูุฏ ุฏุฑุงูุช ฺฉูุฏ.</p>
                            <input type="email" placeholder="ุงูู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ..." id="sidebarEmail">
                            <button onclick="subscribeNewsletter('sidebarEmail')">ุนุถูุช ุฏุฑ ุฎุจุฑูุงูู</button>
                        </div>
                    </aside>
                </div>
            </div>
        </section>
    </div>

    <!-- =================== CATEGORY VIEW =================== -->
    <div id="categoryView" style="display:none;">
        <div class="page-banner">
            <div class="container">
                <h1 id="categoryTitle">๐ ุฏุณุชูโุจูุฏ</h1>
                <p>ุชูุงู ูุทุงูุจ ูุฑุชุจุท ุจุง ุงู ุฏุณุชูโุจูุฏ</p>
            </div>
        </div>
        <section class="main-content">
            <div class="container">
                <div class="content-grid">
                    <div id="categoryPosts"></div>
                    <aside class="sidebar">
                        <div class="widget">
                            <h3 class="widget-title">๐ ุฏุณุชูโุจูุฏโูุง</h3>
                            <ul class="cat-list">
                                <li><a href="index.html?cat=ุชฺฉููููฺ">ุชฺฉููููฺ <span>ฑฒ</span></a></li>
                                <li><a href="index.html?cat=ุจุฑูุงููโููุณ">ุจุฑูุงููโููุณ <span>ฒณ</span></a></li>
                                <li><a href="index.html?cat=ุณุจฺฉ ุฒูุฏฺฏ">ุณุจฺฉ ุฒูุฏฺฏ <span>ธ</span></a></li>
                                <li><a href="index.html?cat=ุขููุฒุด">ุขููุฒุด <span>ฑต</span></a></li>
                                <li><a href="index.html?cat=ฺฉุชุงุจ">ฺฉุชุงุจ ู ูุทุงูุนู <span>ถ</span></a></li>
                            </ul>
                        </div>
                        <div class="widget newsletter-widget">
                            <h3 class="widget-title">๐ฌ ุฎุจุฑูุงูู</h3>
                            <p>ูุทุงูุจ ุฌุฏุฏ ุฑุง ุงุฒ ุฏุณุช ูุฏูุฏ!</p>
                            <input type="email" placeholder="ุงูู ุฎูุฏ..." id="catEmail">
                            <button onclick="subscribeNewsletter('catEmail')">ุนุถูุช</button>
                        </div>
                    </aside>
                </div>
            </div>
        </section>
    </div>

{% endblock %}