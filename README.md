# نوشتار بلاگ (Neveshtar Blog)

نوشتار یک وبلاگ فارسی مبتنی بر Django است که برای انتشار مقاله، مدیریت نویسندگان و تعامل کاربران (نظر، خبرنامه، تماس) طراحی شده است.  
هدف پروژه ارائه یک پایه قابل توسعه برای تیم‌های محتوا، توسعه‌دهندگان Django و صاحبان وبلاگ شخصی/تخصصی است که می‌خواهند پروژه را به‌صورت محلی با Docker Compose اجرا کنند.

## ویژگی‌ها

- `مدیریت پست‌ها (CRUD در ادمین)`: ایجاد، ویرایش و انتشار پست‌ها با وضعیت `draft/published` از پنل مدیریت انجام می‌شود.
- `اسلاگ یونیکد فارسی`: برای هر پست اسلاگ یکتا با پشتیبانی از کاراکترهای فارسی تولید می‌شود.
- `لینک کوتاه برای پست‌ها`: هر پست یک `short_code` یکتا دارد و مسیر `/p/<short_code>/` به لینک اصلی پست ریدایرکت می‌کند.
- `دسته‌بندی و برچسب`: پست‌ها به دسته و چندین تگ متصل می‌شوند و امکان فیلتر بر اساس هرکدام وجود دارد.
- `جستجو`: جستجو روی عنوان و محتوای پست در صفحه اصلی انجام می‌شود.
- `صفحه‌بندی`: لیست پست‌ها با صفحه‌بندی ۱۰‌تایی نمایش داده می‌شود.
- `پست‌های ویژه و مرتبط`: نمایش پست‌های Featured در صفحه اصلی و پست‌های مرتبط در صفحه جزئیات فعال است.
- `ثبت و نمایش نظر`: کاربران احراز هویت‌شده می‌توانند برای هر پست نظر ثبت کنند؛ نظرات تأییدشده نمایش داده می‌شوند.
- `احراز هویت کاربر`: ثبت‌نام، ورود و خروج کاربر از طریق API پیاده‌سازی شده است.
- `کاربر سفارشی`: مدل کاربر اختصاصی با `email` به‌عنوان شناسه ورود استفاده می‌شود.
- `پروفایل نویسنده`: اطلاعات نویسنده اصلی، مهارت‌ها و داستان شخصی در بخش About و سایدبار نمایش داده می‌شود.
- `فرم تماس`: کاربران می‌توانند پیام تماس ثبت کنند و در دیتابیس ذخیره می‌شود.
- `خبرنامه`: ایمیل کاربران برای عضویت در خبرنامه ثبت می‌شود.
- `پنل مدیریت پیشرفته`: با `django-summernote` برای ویرایش محتوای غنی و اکشن‌های مدیریتی برای انتشار/ویژه‌سازی پست‌ها.
- `تاریخ جلالی و اعداد فارسی`: با تمپلیت‌تگ‌های سفارشی، تاریخ‌ها و اعداد برای UI فارسی‌سازی می‌شوند.
- `تولید داده آزمایشی`: دستور `dummy_data` برای ساخت داده نمونه فارسی (کاربر، پروفایل، دسته، تگ، پست) فراهم است.

## فناوری‌ها و ابزارها

- `Python 3.13`: زبان اصلی پیاده‌سازی بک‌اند.
- `Django 5.2`: هسته وب‌اپلیکیشن، مدیریت URL، ORM، پنل ادمین و رندر Template.
- `Django REST Framework`: پیاده‌سازی APIهای نسخه‌بندی‌شده (`/api/v1/`) برای احراز هویت، خبرنامه و نظر.
- `PostgreSQL 16`: دیتابیس اصلی پروژه در Docker Compose.
- `Pillow`: مدیریت فیلدهای تصویر (`ImageField`) برای پست‌ها و پروفایل.
- `django-summernote`: ویرایشگر WYSIWYG در پنل ادمین برای محتوای پست.
- `django-debug-toolbar`: بررسی درخواست‌ها و دیباگ در محیط توسعه.
- `jdatetime`: تبدیل تاریخ میلادی به جلالی در رابط فارسی.
- `Docker`: ساخت ایمیج و اجرای ایزوله سرویس‌ها.
- `Docker Compose`: هماهنگ‌سازی سرویس‌های `backend` (Django) و `db` (PostgreSQL).

## معماری اجرا

```text
[Browser]
    |
    v
[Django container: backend :8000]
    |
    v
[PostgreSQL container: db :5432]
```

- کد پروژه از مسیر `./core` به `/app` کانتینر backend مونت می‌شود.
- سرویس backend با دستور `python manage.py runserver 0.0.0.0:8000` اجرا می‌شود.
- اتصال دیتابیس با هاست `db` (نام سرویس Compose) انجام می‌شود.

## ساختار پروژه

```text
.
├── docker-compose.yml
├── Dockerfile
├── requirements.txt
├── README.md
└── core/
    ├── manage.py
    ├── core/
    │   ├── settings.py
    │   ├── urls.py
    │   └── api_v1_urls.py
    ├── blog/
    │   ├── models/
    │   ├── api/v1/
    │   ├── management/commands/dummy_data.py
    │   ├── templatetags/
    │   ├── views.py
    │   └── urls.py
    ├── accounts/
    │   ├── models/
    │   ├── api/v1/
    │   ├── admin.py
    │   └── urls.py
    ├── templates/
    ├── static/
    └── media/
```

توضیح بخش‌های کلیدی:

- `core/core/settings.py`: تنظیمات اصلی Django شامل اپ‌ها، دیتابیس، استاتیک/مدیا و User Model سفارشی.
- `core/blog/`: منطق دامنه وبلاگ (پست، دسته، تگ، نظر، خبرنامه، تماس).
- `core/accounts/`: مدل کاربر سفارشی، پروفایل نویسنده و API احراز هویت.
- `core/templates/`: قالب‌های HTML صفحات اصلی، جزئیات پست، درباره ما و تماس.
- `docker-compose.yml`: تعریف سرویس‌های backend و db و ولوم دیتابیس.

## نصب و راه‌اندازی محلی با Docker Compose

### پیش‌نیازها

- Docker (نسخه 24 یا بالاتر پیشنهاد می‌شود)
- Docker Compose Plugin (`docker compose`)

### 0) کلون کردن مخزن

```bash
git clone https://github.com/MahdiLatifi/Neveshtar-Blog.git
cd neveshtar-blog
```

### 1) اجرای سرویس‌ها

از ریشه پروژه:

```bash
docker compose up --build
```

برای اجرای پس‌زمینه:

```bash
docker compose up -d --build
```

### 2) اجرای Migrationها

در یک ترمینال جدید:

```bash
docker compose exec backend python manage.py migrate
```

### 3) ساخت ادمین

```bash
docker compose exec backend python manage.py createsuperuser
```

### 4) (اختیاری) تولید داده آزمایشی

```bash
docker compose exec backend python manage.py dummy_data --count 20
```

### 5) دسترسی در مرورگر

- برنامه: `http://localhost:8000/`
- پنل مدیریت: `http://localhost:8000/admin/`


## متغیرهای محیطی (Environment Variables)

در Compose فعلی مقادیر زیر استفاده می‌شوند:

### سرویس `backend`

- `SECRET_KEY=test`
- `DEBUG=True`

### سرویس `db`

- `POSTGRES_DB=mydb`
- `POSTGRES_USER=myuser`
- `POSTGRES_PASSWORD=mypassword`

نکته مهم: تنظیمات دیتابیس در `core/core/settings.py` به‌صورت ثابت تعریف شده‌اند و باید با مقادیر سرویس `db` هماهنگ باشند.

## API (نسخه 1)

پیشوند مشترک: `/api/v1/`

- `POST /api/v1/auth/signup/` ثبت‌نام
- `POST /api/v1/auth/login/` ورود
- `POST /api/v1/auth/logout/` خروج (نیازمند احراز هویت)
- `POST /api/v1/newsletter/` عضویت خبرنامه
- `POST /api/v1/post/<id>/comment/` ثبت نظر برای پست (نیازمند احراز هویت)

## لایسنس

این پروژه تحت لایسنس `MIT` منتشر شده است. جزئیات در فایل `LICENSE` موجود است.

---

## مشارکت و بازخورد

این پروژه به‌عنوان یک نمونه‌کار عملی با Django طراحی و توسعه یافته است.  
در صورت مشاهده باگ، ناسازگاری یا فضایی برای بهبود، خوشحال می‌شوم از طریق [Issues](../../issues) گزارش دهید یا Pull Request ارسال کنید.
